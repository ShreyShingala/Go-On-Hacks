# Image Replacer Backend

A simple Express.js backend server that integrates with Google's Gemini AI to process images and generate prompts for image creation.

## Features

- **Image Upload**: Accept image files (JPEG, PNG, GIF, WebP) up to 10MB
- **Gemini Integration**: Uses Google's Gemini Pro Vision model to analyze uploaded images
- **Prompt Generation**: Generates enhanced prompts for image generation
- **RESTful API**: Simple endpoints for image processing

## Setup

1. **Install Dependencies**
   ```bash
   npm install
   ```

2. **Configure Environment Variables**
   - Copy `.env.example` to `.env`
   - Get your Gemini API key from [Google AI Studio](https://makersuite.google.com/app/apikey)
   - Add your API key to `.env`:
     ```
     GEMINI_API_KEY=your_api_key_here
     PORT=3000
     ```

3. **Start the Server**
   ```bash
   npm start
   ```
   
   For development with auto-reload:
   ```bash
   npm run dev
   ```

## API Endpoints

### POST `/api/generate-image`
Upload an image and get analysis/generation suggestions from Gemini.

**Request:**
- Method: `POST`
- Content-Type: `multipart/form-data`
- Body:
  - `image`: Image file (required)
  - `prompt`: Text prompt describing what you want (optional, defaults to generic prompt)
  - `model`: Gemini model name (optional, defaults to 'gemini-pro-vision')

**Example using curl:**
```bash
curl -X POST http://localhost:3000/api/generate-image \
  -F "image=@/path/to/your/image.jpg" \
  -F "prompt=Generate a new artistic version of this image"
```

**Response:**
```json
{
  "success": true,
  "analysis": "Gemini's analysis of the image...",
  "message": "Image processed successfully..."
}
```

### POST `/api/generate-from-prompt`
Generate an enhanced prompt for image generation using Gemini.

**Request:**
- Method: `POST`
- Content-Type: `application/json`
- Body:
  ```json
  {
    "prompt": "A futuristic cityscape",
    "style": "photorealistic" // optional
  }
  ```

**Example using curl:**
```bash
curl -X POST http://localhost:3000/api/generate-from-prompt \
  -H "Content-Type: application/json" \
  -d '{"prompt": "A futuristic cityscape at sunset", "style": "photorealistic"}'
```

**Response:**
```json
{
  "success": true,
  "originalPrompt": "A futuristic cityscape at sunset",
  "enhancedPrompt": "Enhanced prompt generated by Gemini...",
  "message": "Use this enhanced prompt with an image generation service..."
}
```

### GET `/health`
Health check endpoint.

**Response:**
```json
{
  "status": "ok",
  "message": "Server is running"
}
```

## Important Notes

⚠️ **Gemini API Limitations**: 
- Gemini can analyze and understand images but does not directly generate images
- The API returns text analysis and suggestions
- For actual image generation, you'll need to use services like:
  - Google's Imagen API
  - OpenAI's DALL-E
  - Stability AI's Stable Diffusion
  - Midjourney API

## Example Integration

You can integrate this backend with your Chrome extension by making fetch requests from your content script or popup:

```javascript
const formData = new FormData();
formData.append('image', imageFile);
formData.append('prompt', 'Create a stylized version of this image');

const response = await fetch('http://localhost:3000/api/generate-image', {
  method: 'POST',
  body: formData
});

const data = await response.json();
console.log(data.analysis);
```

## File Structure

```
back-end/
├── server.js          # Main Express server
├── package.json       # Dependencies and scripts
├── .env.example       # Environment variables template
├── .gitignore        # Git ignore rules
├── README.md         # This file
└── uploads/          # Temporary image storage (created automatically)
```

